# 五子棋竞技场进度



## 4/14

建表：

1.User table：存放用户数据，包括：id，昵称（唯一昵称），注册凭证：手机号码或者邮箱二选一，密码；

2.Gamer table：存放游戏数据信息，包括：Gamer_id，段位、战绩、胜率、游玩场次数、胜场数，是否位于房间中

3.HistoricGame table：存放历史对局信息：包括：对局id（对局开始时间（包括年月日时分秒组成）与顺序生产的3位数字组成，共17位），对局起止时间、对战信息（对手，对战结果）

4.RealTimeGame table：存放实时对局信息，包括：对局id（对局开始时间（包括年月日时分秒组成）与顺序生产的3位数字组成，共17位），棋子位置（要存放两个人的数据），对局开始时间，对局玩家信息，用户在线情况

5.Room table：存放房间数据，包括：房间号（月份加日期和4位随机数字），是否公开，房间密码（不公开则为空字符串），房主id，嘉宾id

6.chessstyle：将对局与最终棋盘样式关联，包括：id：对局id，finalchessstyle：最终棋盘样式的id，由对局结束时间（包括年月日时分秒）和对局id的最后四位组成，共17位

7.chessStyle：将对局与棋盘进行关联，包括：id(对局id)，finalchessstyle_id(27位)棋盘样式id（最终棋盘样式实际上时更新到胜负分晓后的棋盘样式）





User与Gamer通过id外键连接，

HistoricGame 与Gamer 通过Gamer_with_HistoricGame表关联,通过game_id与棋盘最终样式关联

RealTimeGame与HIstoricGame通过对局id进行关联，通过game_id与实时棋盘样式关联

Room通过Gamer_id与Gamer相关联





**为了解决棋盘数据庞大导致查询时间过长，采用动态创建棋盘表的方式：**

**棋盘：数据库名由对局id+chess_style(27位)组成**

​		**包括：chess_possion**

**棋子:包括：棋子id（判断第几步，自动更新），棋子坐标chess_possion（char（2）），八个方位的Boolean值（forward,rear,left,right,leftfront,leftrear,rightfront,rightrear）**





解决快速判断棋子是否连成一条线的方法：在棋子周围设置8个方位为boolean值，如果为true则记录对应方向并向对应方向进行延申，并设置一个计数器，如果计数器达到5则判为胜





